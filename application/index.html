<!DOCTYPE html>
<html>
<head>
	<title>MinimalNews</title>
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='templates/style.css') }}">
	<script src="{{ url_for('static', filename='https://code.jquery.com/jquery-2.2.4.js') }}" integrity="sha256-iT6Q9iMJYuQiMWNd9lDyBUStIq/8PuOW33aOqmvFpqI=" crossorigin="anonymous"></script>
</head>
<body id="body" onload="firstLoad()">

<div id="main_content">
	<h1 id='header_text'>Good <span id="daytime"></span> Joe,</h1>
	<h2 id='main_text'>Here goes the summary in general, shouldn't be more than a 4 or 5 lines. It should contain some <a href="http://crazy.com">links</a> which will lead to the actual news. But this will contain more than two lines... This text doesn't actually mean anything, it's just filler. I could use Lorem Ipsum, but I'm lazy. Hopefuly this is enough.</h2>
	<h5><a href="javascript:tellMeMore()">Tell me more</a></h5>
</div>
<div id="main_bar">
	<p><a href="javascript:toggleScheme()">Toggle scheme</a> | <a href="javascript:callPython()">Go python</a></p>
</div>

<p id="keyword1" class="keyword">example1</p>
<p id="keyword2" class="keyword">example2</p>
<p id="keyword3" class="keyword">example3</p>
<p id="keyword4" class="keyword">example4</p>

</body>

<script type="text/javascript">
	function callPython() {
		datatosend = 'this is my matrix';
        result = runPyScript(datatosend);
        console.log('Got back ' + result);
	}

	function runPyScript(input){
        var jqXHR = $.ajax({
            type: "POST",
            url: "http://localhost/minimalnews/login",
            async: false,
            data: { mydata: input }
        });

        return jqXHR.responseText;
    }

	function toggleScheme() {
		var x = document.querySelector('body');
		if (x.style.background == "black") {
			x.style.background = "white";
			document.getElementById("header_text").style.color = "black";
			document.getElementById("main_text").style.color = "#424242";
			for (var i = 1; i <= 4; i++) {
				var kword = "keyword".concat(i);
				document.getElementById(kword).style.color = "#D3D3D3";
			}
		} else {
			x.style.background = "black";
			document.getElementById("header_text").style.color = "white";
			document.getElementById("main_text").style.color = "#CECECE";
			for (var i = 1; i <= 4; i++) {
				var kword = "keyword".concat(i);
				document.getElementById(kword).style.color = "#525252";
			}
		}
	}

	function firstLoad() {
		var d = new Date();
		var n = d.getHours();
		if (n < 12 && n > 5) {
			document.getElementById("daytime").innerHTML = "Morning";
		} else if (n < 19) {
			document.getElementById("daytime").innerHTML = "Afternoon";
		} else {
			document.getElementById("daytime").innerHTML = "Evening";
		}

		// TODO: call the function to call the news API and concatenate the text of all of them
		// TODO: call a placeholder function summarize and use the return of this function in the innerHTML
		document.getElementById("main_text").style.opacity = 1;
		for (var i = 1; i <= 4; i++) {
			var kword = "keyword".concat(i);
			var rand1 = 2*Math.random()+2;
			document.getElementById(kword).style.transition = "opacity ".concat(rand1, "s");
			document.getElementById(kword).style.opacity = 1;
		}
	}

	function tellMeMore() {
		// go back
		document.getElementById("main_text").style.transition = "opacity 1s";
		document.getElementById("main_text").style.opacity = 0;
		for (var i = 1; i <= 4; i++) {
			var kword = "keyword".concat(i);
			document.getElementById(kword).style.transition = "opacity 1.5s";
			document.getElementById(kword).style.opacity = 0;
		}

		setTimeout(function(){
			// change the text by calling the functions
			// TODO: call the function to call the news API and concatenate the text of all of them
			// TODO: call a placeholder function summarize and use the return of this function in the innerHTML
			document.getElementById("main_text").innerHTML = "Works";
			var pixel_array = ["10px", "81px", "40px", "115px"];

			// go back
			document.getElementById("main_text").style.transition = "opacity 1.5s";
			document.getElementById("main_text").style.opacity = 1;
			for (var i = 1; i <= 4; i++) {
				var kword = "keyword".concat(i);
				document.getElementById(kword).style.position = "absolute";
				document.getElementById(kword).style.top = pixel_array[i-1];
				document.getElementById(kword).style.left = Math.ceil(1000*Math.random()).toString().concat("px");
				var rand1 = 2*Math.random();
				document.getElementById(kword).style.transition = "opacity ".concat(rand1, "s");
				document.getElementById(kword).style.opacity = 1;
			}
		}, 1500); 
	}

	// TODO: functions to call the news API and summarize the concatenation
</script>
</html>